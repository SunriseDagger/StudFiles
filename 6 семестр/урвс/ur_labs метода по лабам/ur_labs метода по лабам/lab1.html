<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>

 <head>
  <title>Лабораторная работа № 1</title>
  <meta http-equiv=Content-Type content="text/html; charset=windows-1251">
  <meta content="MSHTML 6.00.2900.2180" name=generator>
  <link rel="stylesheet" type="text/css" href="textstyle.css">
  <!--base href="http://ami.nstu.ru/~vms/method6/"-->
 </head>

 <body>

  <div class="header">
   Лабораторная работа № 1
  </div>
  <div class="mainheader">
   Управление системными ресурсами средствами shell-интерпретатора
  </div>
  
  <div class="header">
   Цель работы
  </div>
  <div class="abzac">
   Ознакомиться с основами программирования на уровне командного языка Shell путём написания 
   Shell-программ для работы с файловой системой.
  </div>
  
  <div class="header">
   Содержание работы
  </div>
  <ol>
   <li>
    Изучить программные средства языка Shell (структура команды, группирование команд, перенаправление ввода-вывода, 
    конвейер команд, Shell-переменные, макроподстановка результатов в Shell-командах, программные конструкции). 
   </li>
   <li>
    Ознакомиться с заданием к лабораторной работе. 
   </li>
   <li>
    Для указанного варианта составить Shell-программу, выполняющую требуемые действия в файловой системе. 
   </li>
   <li>
    Отладить и оттестировать составленную Shell-программу. 
   </li>
   <li>
    Защитить лабораторную работу, ответив на контрольные вопросы.
   </li>
  </ol>

  <div class="header">
   Методические указания к лабораторной работе
  </div>
  <div class="abzac">
   Обычно в ОС UNIX доступны несколько интерпретаторов. Наиболее распространены Bourne-shell (или просто - shell), C-shell, 
   Korn-shell. В идейном плане все эти интерпретаторы близки и в дальнейшем речь будет идти о стандартном Shell (/bin/sh).
  </div>
  <div class="abzac">
   Работая на командном языке, пользователь может вводить переменные, присваивать им значения, выполнять простые команды,
   строить составные команды, управлять потоком выполнения команд, объединять последовательность команд в процедуры (командные 
   файлы). На уровне командного языка доступны такие свойства системы как соединение процессов через программный канал, направление
   стандартного ввода/вывода в конкретные файлы, синхронное и асинхронное выполнение команд.
  </div>
  <div class="abzac">
   Если указанный интерпретатору файл является текстовым и содержит команды командного языка (командный файл) и при этом имеет
   разрешение на выполнение (помечен "х"), Shell-интерпретатор интерпретирует и выполняет команды этого файла. Другой способ 
   вызова командного файла - использование команды sh (вызов интерпретатора), в котором первым аргументом указывается имя командного
   файла.
  </div>
  <div class="abzac">
   Коротко перечислим средства группирования команд и перенаправления ввода/вывода:
  </div>
  <ul>
   <li>
    <span class="code">cmd1 arg ...; cmd2 arg ...; ... cmdN arg ...</span> - последовательное выполнение команд; 
   </li>
   <li>
    <span class="code">cmd1 arg ... &amp; cmd2 arg ... &amp; ... cmdN arg ...</span> - асинхронное выполнение команд; 
   </li>
   <li>
    <span class="code">cmd1 arg ... &amp;&amp; cmd2 arg ...</span> - зависимость последующей команды от предыдущей таким образом, что последующая 
    команда выполняется, если предыдущая выдала нулевое значение; 
   </li>
   <li>
    <span class="code">cmd1 arg ... || cmd2 arg ...</span> - зависимость последующей команды от предыдущей таким образом, что последующая команда 
    выполняется, если предыдущая выдала ненулевое значение; 
   </li>
   <li>
    <span class="code">cmd > file</span> - стандартный вывод направлен в файл file; 
   </li>
   <li>
    <span class="code">cmd >> file</span> - стандартный вывод направлен в конец файла file;
   </li>
   <li>
    <span class="code">cmd < file</span> - стандартный ввод выполняется из файла file; 
   </li>
   <li>
    <span class="code">cmd1 | cmd2</span> - конвейер команд, в котором стандартный вывод команды cmd1 направлен на стандартный вход команды cmd2.
   </li>
  </ul>
  <div class="abzac">
   Shell-переменные могут хранить строки текста. Правила формирования их имен аналогичны правилам задания имен переменных 
   в обычных языках программирования. При необходимости присвоить Shell-переменной значение, содержащее пробелы и другие 
   специальные знаки, оно заключается в кавычки. При использовании Shell-переменной в выражении ее имени должен предшествовать 
   знак <span class="code">$</span>. В последовательности символов те из них, которые составляют имя, должны быть выделены в 
   <span class="code">{ }</span> или <span class="code">" "</span>. Кроме того, интерпретатор Shell автоматически присваивает 
   значения пяти своим переменным:
  </div>
  <ul>
   <li>
    <span class="code">$?</span> - значение, возвращаемое последней выполняемой командой;
   </li>
   <li>
    <span class="code">$$</span> - идентификационный номер процесса Shell;
   </li>
   <li>
    <span class="code">$!</span> - идентификационный номер фонового процесса, запускаемого интерпретатором Shell последним; 
   </li>
   <li>
    <span class="code">$#</span> - число аргументов, переданных в Shell;  
   </li>
   <li>
    <span class="code">$&ndash;</span> - флаги, переданные в Shell.
   </li>
  </ul>
  <div class="abzac">
   Для отмены специальных символов (<span class="code">$</span>, <span class="code">|</span>, пробел и т.д.) в Shell-программах 
   существуют следующие правила:
  </div>
  <ul>
   <li>
    если символу предшествует обратная косая черта, то его специальный символ отменяется; 
   </li>
   <li>
    отменяется специальный смысл всех символов, вошедших в последовательность, заключенную в апострофы.
   </li>
  </ul>
  <div class="abzac">
   При вызове Shell-программ им могут передаваться параметры. Соответствующие аргументы в Shell-программах идентифицируются 
   <span class="code">$1</span>, <span class="code">$2</span>, <span class="code">$3</span> и т.д. Кроме того, переменная 
   <span class="code">$0</span> соответствует имени выполняемой Shell-программы, а переменная <span class="code">$#</span> 
   - числу аргументов в команде.
  </div>
  <div class="abzac">
   Shell-интерпретатор дает возможность выполнять подстановку результатов выполнения команд в Shell-программах. Если команда 
   заключена в одиночные обратные кавычки, то интерпретатор Shell выполняет эту команду и подставляет вместо нее полученный
   результат.
  </div>
  <div class="abzac">
   Наиболее важные команды для составления Shell-программ:
  </div>
  <ul>
   <li>
    команда <span class="code">echo</span> выводит в выходной поток значения своих аргументов;
   </li>
   <li>
    команда <span class="code">expr</span> выполняет арифметические действия над своими аргументами; 
   </li>
   <li>
    команда <span class="code">eval</span> обеспечивает дополнительный уровень подстановки своих аргументов, а затем их выполнение; 
   </li>
   <li>
    команда <span class="code">test</span> с соответствующими ключами проверяет необходимое условие;
   </li>
   <li>
    команда <span class="code">sleep</span> служит для реализации задержки. 
   </li>
  </ul>
  <div class="abzac">
   Программные конструкции Shell-программ:
  </div>
  <div class="picture">
   <img src="images/p1_0.jpg">
  </div>

  <div class="header">
   Варианты заданий
  </div>
  <ol>
   <li>
    Shell-программа выводит имена тех каталогов в каталоге, которые в себе содержат каталоги. Имя каталога задано 
    параметром Shell-программы.
   </li>

   <li>
    Shell-программа просматривает каталог, имя которого указано параметром Shell-программы и выводит имена встретившихся 
    каталогов. Затем осуществляет переход в родительский каталог, который становится текущим и повторяются указанные 
    действия до тех пор, пока текущим каталогом не станет корневой каталог. Форма вывода результата:
    <div class="picture">
     <img src="images/p1_4.jpg">
    </div>
   </li>

   <li>
    Shell-программа подсчитывает количество и выводит перечень каталогов в хронологическом порядке (по дате создания) в 
    поддереве, начиная с каталога, имя которого задано параметром Shell-программы. Форма вывода результата:
    <div class="picture">
     <img src="images/p1_2.jpg">
    </div>
   </li>

   <li>
    Shell-программа объединяет все временные файлы с указанным суффиксом (например, .tmp) в поддереве, начиная с 
    каталога, имя которого задано параметром Shell-программы. Результат объединения помещается либо в указанный 
    Shell-программой файл, либо выводится на экран в форме:
    <div class="picture">
     <img src="images/p1_3.jpg">
    </div>
   </li>

   <li>
    Shell-программа периодически с некоторым интервалом удаляет все временные файлы с указанным суффиксом (например, 
    .tmp) в поддереве, начиная с каталога, имя которого задано параметром Shell-программы и выводит при этом список 
    объединенных файлов в форме:
    <div class="picture">
     <img src="images/p1_1.jpg">
    </div>
   </li>

   <li>
    Shell-программа выводит содержимое каталога, имя которого указано параметром Shell-программы. При выводе сначала 
    перечисляются имена каталогов, а затем в алфавитном порядке имена файлов с указанием их длин, даты создания и числа 
    ссылок на них.
   </li>

   <li>
    Shell-программа подсчитывает количество и выводит список всех файлов (без каталогов) в порядке уменьшения их длин в 
    поддереве, начиная с каталога, имя которого задано параметром Shell-программы. Форма вывода результата:
    <div class="picture">
     <img src="images/p1_1.jpg">
    </div>
   </li>

   <li>
    Shell-программа просматривает каталог, имя которого указано параметром Shell-программы и выводит имена встретившихся 
    файлов. Затем осуществляет переход в родительский каталог, который становится текущим и повторяются указанные 
    действия до тех пор, пока текущим каталогом не станет корневой каталог. Форма вывода результата:
    <div class="picture">
     <img src="images/p1_4.jpg">
    </div>
   </li>

   <li>
    Shell-программа подсчитывает количество и выводит список всех файлов (без каталогов) в алфавитном порядке в  
    поддереве, начиная с каталога, имя которого задано параметром Shell-программы. Форма вывода результата:
    <div class="picture">
     <img src="images/p1_1.jpg">
    </div>
   </li>

   <li>
    Shell-программа выводит имена тех каталогов в каталоге, которые в себе не содержат каталогов. Имя каталога задано 
    параметром Shell-программы.
   </li>
  </ol>

  <div class="header">
   Контрольные вопросы
  </div>
  <ol>
   <li>
    Что такое внутренние и внешние команды Shell-интерпретатора? Приведите примеры внутренних команд.
   </li>
   <li>
    Какие существуют средства группирования команд? Приведите примеры использования. 
   </li>
   <li>
    Как осуществляется перенаправление ввода-вывода?
   </li>
   <li>
    В чем сущность конвейера команд? Приведите примеры использования. 
   </li>
   <li>
    Как средствами Shell выполнить арифметические действия над Shell-переменной? 
   </li>
   <li>
    Каковы правила генерации имен файлов? 
   </li>
   <li>
    Как выполняется подстановка результатов выполнения команд?
   </li>
   <li>
    Как интерпретировать строку <span class="code">cmd1 & cmd2 &</span> ? 
   </li>
   <li>
    Как интерпретировать строку <span class="code">cmd1 && cmd2 &</span> ?
   </li>
   <li>
    Как интерпретировать строку <span class="code">cmd1 || cmd2 &</span> ? 
   </li>
   <li>
    В каком режиме выполняется интерпретатор команд Shell? 
   </li>
   <li>
    Кем и в каком режиме осуществляется чтение потока символов с терминала интерпретатором Shell? 
   </li>
  </ol>

 </body>
</html>
