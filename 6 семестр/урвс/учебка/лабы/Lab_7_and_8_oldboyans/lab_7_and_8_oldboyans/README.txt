Местами - ГОВНИЩЕ редкостное.
Но на основе этого можно что-то нормальное сделать.
Да, 7 вариант вообще ГОВНЯНО тут сделан, лучше не использовать.